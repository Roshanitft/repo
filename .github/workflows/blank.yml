name: py

on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  schedule: 
    - cron: '31 1 * * *'

jobs:
  build:
        runs-on: ubuntu-latest

        steps:
          - name: checkout repo content
            uses: actions/checkout@v2 # checkout the repository content to github runner.
          - name: setup python
            uses: actions/setup-python@v2
            with:
              python-version: 3.8 #install the python needed
          - name: execute py script # run the run.py to get the latest data
            run: |
              python run.py
              
          - name: Send mail
            if: always()
            uses: dawidd6/action-send-mail@v2
            with:
    # mail server settings
              server_address: smtp.gmail.com
              server_port: 465
    # user credentials
              username: ${{ secrets.EMAIL_USERNAME }}
              password: ${{ secrets.EMAIL_PASSWORD }}
    # email subject
              subject: ${{ github.job }} job of ${{ github.repository }} has ${{ job.status }}
    # email body as text
              body: ${{ github.job }} job in worflow ${{ github.workflow }} of ${{ github.repository }} has ${{ job.status }}
    # comma-separated string, send email to
              to: roshanilalwani1111@gmail.com
    # from email name
              from: Sahid
